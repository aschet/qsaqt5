<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- ../../examples/scriptbutton/scriptbutton.qdoc -->
<head>
  <title>QSA 1.2: Scriptbutton Example</title>
    <style type="text/css">h3.fn,span.fn { margin-left: 1cm; text-indent: -1cm; }
a:link { color: #004faf; text-decoration: none }
a:visited { color: #672967; text-decoration: none }
td.postheader { font-family: sans-serif }
tr.address { font-family: sans-serif }
body { background: #ffffff; color: black; }</style>
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qt-logo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="getting-started.html"><font color="#004faf">Tutorial</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">Classes</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a>&nbsp;&middot; <a href="language.html"><font color="#004faf">Language</font></a>&nbsp;&middot; <a href="workbench-reference.html"><font color="#004faf">QSA Workbench</font></a>&nbsp;&middot; <a href="http://doc.trolltech.com/4.1"><font color="#004faf">Qt Documentation</font></a>&nbsp;&middot; <a href="http://www.trolltech.com/"><font color="#004faf">www.trolltech.com</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 class="title">Scriptbutton Example<br /><span class="subtitle"></span>
</h1>
<p>The Scriptbutton example demonstrates how to implement a GUI control with a customizable action on activation. ScriptButton is a specialized <tt>QPushButton</tt> class that can have a snippet of script code attached to it. The script will be executed whenever the user clicks on the button. To modify the behavior of the buttons, the user can right-click a button and choose to either rename the button label or edit the script code in a simple editor.</p>
<p>The Scriptbutton example also shows how to extend the scripting API of an existing C++ <tt>QObject</tt> class, which in this case is <tt>QWidget</tt>. Here we extend every QWidget class by two scripting functions: <tt>sendMousePressEvent()</tt> and <tt>sendMouseReleaseEvent()</tt>. These functions will show up in the API of every <tt>QWidget</tt> subclass and will then allow the scriptwriter to send mouse press and release events to any <tt>QWidget</tt>.</p>
<p>For demonstration purposes, the example widget contains both a <tt>QLCDNumber</tt> and <tt>QLineEdit</tt> widget with properties that can be changed by the buttons located on the right side of the dialog.</p>
<a name="implementing-scriptbutton"></a>
<h2>Implementing Scriptbutton</h2>
<p>The scriptbutton is a <tt>QPushButton</tt> subclass and contains an extra property which stores the code that will be executed when clicking the button. To edit the code, a subclass of <tt>QSEditor</tt> is used. The scriptbutton's code is passed into a call to <tt>QSInterpreter::evaluate()</tt> in the scriptbutton's <tt>executeScript()</tt> slot, which is connected to its <tt>clicked()</tt> signal.</p>
<a name="implementation-of-the-qwidget-extension"></a>
<h2>Implementation of the QWidget Extension</h2>
<p>To extend the <tt>QWidget</tt> API for the script writer, we implement a class <tt>WidgetWrapper</tt> which inherits <tt>QObject</tt> and takes the widget it wraps in its constructor. <tt>WidgetWrapper</tt> then implements the two slots <tt>sendMousePressEvent()</tt> and <tt>sendMouseReleaseEvent()</tt> which send a mouse event to the wrapped widget.</p>
<p>To make this wrapper known to the Qt Script Interpreter, we implement a <tt>WidgetWrapperFactory</tt> which inherits <tt>QSWrapperFactory</tt>. This enables the Qt Script Interpreter to create a WidgetWrapper for every <tt>QWidget</tt> it exposes to Qt Script.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td width="30%">Copyright &copy; 2008 <a href="http://www.trolltech.com">Trolltech</a></td>
<td width="40%" align="center"><a href="http://www.trolltech.com/company/copyright.html">Trademarks</a></td>
<td width="30%" align="right"><div align="right">QSA 1.2.3</div></td>
</tr></table></div></address></body>
</html>
